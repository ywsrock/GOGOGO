# VB6 フォーム解析



### コード

https://github.com/ywsrock/GOGOGO/tree/master/00_33_vb6FormParse



## 機能の概要

このコードは、次の主な機能を持っています：

- ファイルのオープンと読み込み

- Excelファイルのテンプレートの読み込み

- 文字列のバッファ作成

- 行の置換とトリミング

- マップへの情報の格納

- 標準出力へのヘッダーの出力

- Excelファイルへの値の書き込み

  

### 関数説明

- `main` 関数: ファイルのオープン、Excelファイルのテンプレート読み込み、文字列のバッファ作成などの初期化処理を行います。また、ファイルのスキャン、行のトリミング、行の置換などの処理を実行します。
- `writeHeader` 関数: 標準出力のヘッダーを出力します。ヘッダーには「Name」「Type」「Caption」「Text」「IMEMode」「Enabled」「Object.Width」「Locked」という列が含まれます。
- `replaceLine` 関数: 行の文字列を受け取り、行の置換やトリミングを行います。また、特定のキーワードを含む行の情報をマップに格納します。
- `pickUpWord` 関数: 行の文字列を受け取り、"Begin" で始まる行の情報を抽出します。抽出した情報はマップに格納され、バッファの内容は出力されます。
- `WriteExcel` 関数: マップに格納された情報をもとに、Excelファイルに値を書き込みます。マップのキーに応じて、各列に対応するセルに値を設定します。
- `PrintStdout` 関数: マップに格納された情報をもとに、標準出力に内容を出力します。各列の値をタブ区切りで出力します。
- `OpenTemplateExcel` 関数: 指定されたExcelファイルを開きます。`excelize` パッケージを使用して、ファイルを読み込みます。
- `TrimF` 関数: 文字列のトリミングを行います。スペースやダブルクォーテーションを削除するための関数です。



以上！