VERSION 5.00
Object = "{00F72214-59C6-45B0-840A-F09FDEB2D5F4}#3.4#0"; "PhoneAPI.ocx"
Object = "{7571CEA4-BD56-40F8-8C6B-4E938351380F}#1.0#0"; "afValue.ocx"
Begin VB.Form frmMain 
   BackColor       =   &H00008000&
   BorderStyle     =   3  'å≈íË¿ﬁ≤±€∏ﬁ
   ClientHeight    =   13455
   ClientLeft      =   45
   ClientTop       =   45
   ClientWidth     =   1470
   ControlBox      =   0   'False
   BeginProperty Font 
      Name            =   "ÇlÇr Çoñæí©"
      Size            =   11.25
      Charset         =   128
      Weight          =   700
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   LinkTopic       =   "Form1"
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   13455
   ScaleWidth      =   1470
   ShowInTaskbar   =   0   'False
   Begin PhoneAPI.ucPhoneApi ucPhoneApi1 
      Height          =   1215
      Left            =   1080
      TabIndex        =   14
      Top             =   660
      Visible         =   0   'False
      Width           =   1275
      _ExtentX        =   2249
      _ExtentY        =   2143
   End
   Begin afValue.Value afValue 
      Left            =   1080
      Top             =   0
      _ExtentX        =   635
      _ExtentY        =   344
   End
   Begin VB.PictureBox Picture1 
      BackColor       =   &H00C0E0FF&
      Height          =   13335
      Left            =   60
      ScaleHeight     =   13275
      ScaleWidth      =   1275
      TabIndex        =   0
      Top             =   60
      Width           =   1335
      Begin VB.CommandButton btnMenu 
         Caption         =   "ÉVÉXÉeÉÄ"
         BeginProperty Font 
            Name            =   "ÇlÇr Çoñæí©"
            Size            =   9.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   900
         Index           =   12
         Left            =   120
         Picture         =   "frmMain.frx":0000
         Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
         TabIndex        =   13
         Top             =   12300
         Width           =   1035
      End
      Begin VB.CommandButton btnMenu 
         Caption         =   "É}ÉXÉ^"
         BeginProperty Font 
            Name            =   "ÇlÇr Çoñæí©"
            Size            =   9.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   900
         Index           =   11
         Left            =   120
         Picture         =   "frmMain.frx":030A
         Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
         TabIndex        =   12
         Top             =   11285
         Width           =   1035
      End
      Begin VB.CommandButton btnMenu 
         Caption         =   "ÉÜÅ[ÉU"
         BeginProperty Font 
            Name            =   "ÇlÇr Çoñæí©"
            Size            =   9.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   900
         Index           =   10
         Left            =   120
         Picture         =   "frmMain.frx":0614
         Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
         TabIndex        =   11
         Top             =   10270
         Width           =   1035
      End
      Begin VB.CommandButton btnMenu 
         Caption         =   "êÍópã∆ñ±"
         BeginProperty Font 
            Name            =   "ÇlÇr Çoñæí©"
            Size            =   9.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   900
         Index           =   9
         Left            =   120
         Picture         =   "frmMain.frx":091E
         Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
         TabIndex        =   10
         Top             =   9255
         Width           =   1035
      End
      Begin VB.CommandButton btnMenu 
         Caption         =   "CTI"
         BeginProperty Font 
            Name            =   "ÇlÇr Çoñæí©"
            Size            =   9.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   900
         Index           =   8
         Left            =   120
         Picture         =   "frmMain.frx":0C28
         Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
         TabIndex        =   9
         Top             =   8240
         Width           =   1035
      End
      Begin VB.CommandButton btnMenu 
         Caption         =   "OBä«óù"
         BeginProperty Font 
            Name            =   "ÇlÇr Çoñæí©"
            Size            =   9.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   900
         Index           =   7
         Left            =   120
         Picture         =   "frmMain.frx":0F32
         Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
         TabIndex        =   8
         Top             =   7225
         Width           =   1035
      End
      Begin VB.CommandButton btnMenu 
         Caption         =   "ÉAÉCÉeÉÄ"
         BeginProperty Font 
            Name            =   "ÇlÇr Çoñæí©"
            Size            =   9.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   900
         Index           =   6
         Left            =   120
         Picture         =   "frmMain.frx":123C
         Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
         TabIndex        =   7
         Top             =   6210
         Width           =   1035
      End
      Begin VB.CommandButton btnMenu 
         Caption         =   "ÉfÅ[É^"
         BeginProperty Font 
            Name            =   "ÇlÇr Çoñæí©"
            Size            =   9.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   900
         Index           =   5
         Left            =   120
         Picture         =   "frmMain.frx":1546
         Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
         TabIndex        =   6
         Top             =   5195
         Width           =   1035
      End
      Begin VB.CommandButton btnMenu 
         Caption         =   "í†ï["
         BeginProperty Font 
            Name            =   "ÇlÇr Çoñæí©"
            Size            =   9.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   900
         Index           =   4
         Left            =   120
         Picture         =   "frmMain.frx":1850
         Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
         TabIndex        =   5
         Top             =   4180
         Width           =   1035
      End
      Begin VB.CommandButton btnMenu 
         Caption         =   "ê\ëóä«óù"
         BeginProperty Font 
            Name            =   "ÇlÇr Çoñæí©"
            Size            =   9.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   900
         Index           =   3
         Left            =   120
         Picture         =   "frmMain.frx":1B5A
         Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
         TabIndex        =   4
         Top             =   3165
         Width           =   1035
      End
      Begin VB.CommandButton btnMenu 
         Caption         =   "àÀóäèë"
         BeginProperty Font 
            Name            =   "ÇlÇr Çoñæí©"
            Size            =   9.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   900
         Index           =   2
         Left            =   120
         Picture         =   "frmMain.frx":1E64
         Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
         TabIndex        =   3
         Top             =   2145
         Width           =   1035
      End
      Begin VB.CommandButton btnMenu 
         Caption         =   "âûëŒä«óù"
         BeginProperty Font 
            Name            =   "ÇlÇr Çoñæí©"
            Size            =   9.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   900
         Index           =   1
         Left            =   120
         Picture         =   "frmMain.frx":216E
         Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
         TabIndex        =   2
         Top             =   1135
         Width           =   1035
      End
      Begin VB.CommandButton btnMenu 
         Caption         =   "ÉÅÉCÉì"
         BeginProperty Font 
            Name            =   "ÇlÇr Çoñæí©"
            Size            =   9.75
            Charset         =   128
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   900
         Index           =   0
         Left            =   120
         Picture         =   "frmMain.frx":2478
         Style           =   1  '∏ﬁ◊Ã®Ø∏Ω
         TabIndex        =   1
         Top             =   120
         Width           =   1035
      End
   End
End
Attribute VB_Name = "frmMain"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private Sub mBtnControl()

    On Error GoTo Err_mBtnControl

    '    Public Const FUNC_000401 As String = "000401"    ' [âûëŒä«óù]
    '    Public Const FUNC_000402 As String = "000402"    ' [àÀóäèë]
    '    Public Const FUNC_000403 As String = "000403"    ' [ê\ëóä«óù]
    '    Public Const FUNC_000404 As String = "000404"    ' [í†ï[]
    '    Public Const FUNC_000405 As String = "000405"    ' [ÉfÅ[É^]
    '    Public Const FUNC_000406 As String = "000406"    ' [ÉAÉCÉeÉÄ]
    '    Public Const FUNC_000407 As String = "000407"    ' [OBä«óù]
    '    Public Const FUNC_000408 As String = "000408"    ' [CTI]
    '    Public Const FUNC_000409 As String = "000409"    ' [êÍópã∆ñ±]
    '    Public Const FUNC_000410 As String = "000410"    ' [ÉÜÅ[ÉU]
    '    Public Const FUNC_000411 As String = "000411"    ' [É}ÉXÉ^]
    '    Public Const FUNC_000412 As String = "000412"    ' [ÉVÉXÉeÉÄ]

    If AF_FuncCheck(FUNC_000401, afValue) = False Then btnMenu(1).Enabled = False
    If AF_FuncCheck(FUNC_000402, afValue) = False Then btnMenu(2).Enabled = False
    If AF_FuncCheck(FUNC_000403, afValue) = False Then btnMenu(3).Enabled = False
    If AF_FuncCheck(FUNC_000404, afValue) = False Then btnMenu(4).Enabled = False
    If AF_FuncCheck(FUNC_000405, afValue) = False Then btnMenu(5).Enabled = False
    If AF_FuncCheck(FUNC_000406, afValue) = False Then btnMenu(6).Enabled = False
    If AF_FuncCheck(FUNC_000407, afValue) = False Then btnMenu(7).Enabled = False
    If AF_FuncCheck(FUNC_000408, afValue) = False Then btnMenu(8).Enabled = False
    If AF_FuncCheck(FUNC_000409, afValue) = False Then btnMenu(9).Enabled = False
    If AF_FuncCheck(FUNC_000410, afValue) = False Then btnMenu(10).Enabled = False
    If AF_FuncCheck(FUNC_000411, afValue) = False Then btnMenu(11).Enabled = False
    If AF_FuncCheck(FUNC_000412, afValue) = False Then btnMenu(12).Enabled = False

Exit_mBtnControl:
    Exit Sub

Err_mBtnControl:
    MsgBox Err.Description
    Resume Exit_mBtnControl

End Sub

'---------------------------------------------------------------------
' ñ⁄ìIê‡ñæ  -- É{É^Éìâüâ∫
' à¯êî      --
' ñﬂÇËíl    -- Ç»Çµ
'---------------------------------------------------------------------
Private Sub btnMenu_Click(Index As Integer)
    On Error GoTo Err_btnMenu_Click

    Dim Rq As Long
    Dim strAppl As String
    Dim cnn As New ADODB.Connection

    strAppl = ""

    cnn.Open gDbConnectionString

    Select Case Index

    Case 0  ' ÉÅÉCÉì
        If ucPhoneApi1.MultiMain = 0 Or gLogonMode <> 9 Then
            'ÅuÉÅÉCÉìÅvíPì∆ãNìÆÉÇÅ[ÉhÇ‹ÇΩÇÕÉAÉEÉgÉoÉEÉìÉhÇÃÇ∆Ç´ÇÕãNìÆéûÇ…É{É^ÉìDisableÇ…Ç∑ÇÈ
            btnMenu(Index).Enabled = False
            TraceLog LOG_DBG, "ÅuÉÅÉCÉìÅvÉ{É^Éìñ≥å¯"
        Else
            btnMenu(Index).Enabled = True
            TraceLog LOG_DBG, "ÅuÉÅÉCÉìÅvÉ{É^ÉìóLå¯"
        End If
        strAppl = SQL_GET_PROFILE_STRING(gDbConnectionString, SECTION_BUTTON, "000")

    Case 1
        ' âûëŒä«óù
        strAppl = SQL_GET_PROFILE_STRING(gDbConnectionString, SECTION_BUTTON, "010")
        ' AccessLog -----------
        AF_InsUserAccessLog FUNC_000401, True, cnn

    Case 2  ' àÀóäèë
        strAppl = SQL_GET_PROFILE_STRING(gDbConnectionString, SECTION_BUTTON, "020")

        ' AccessLog -----------
        AF_InsUserAccessLog FUNC_000402, True, cnn

    Case 3  ' ê\ëóéñçÄ
        strAppl = SQL_GET_PROFILE_STRING(gDbConnectionString, SECTION_BUTTON, "030")

        ' AccessLog -----------
        AF_InsUserAccessLog FUNC_000403, True, cnn

    Case 4  ' í†ï[
        strAppl = SQL_GET_PROFILE_STRING(gDbConnectionString, SECTION_BUTTON, "040")

        ' AccessLog -----------
        AF_InsUserAccessLog FUNC_000404, True, cnn

    Case 5  ' ÉfÅ[É^
        strAppl = SQL_GET_PROFILE_STRING(gDbConnectionString, SECTION_BUTTON, "050")

        ' AccessLog -----------
        AF_InsUserAccessLog FUNC_000405, True, cnn

    Case 6  ' ÉAÉCÉeÉÄ
        strAppl = SQL_GET_PROFILE_STRING(gDbConnectionString, SECTION_BUTTON, "060")

        ' AccessLog -----------
        AF_InsUserAccessLog FUNC_000406, True, cnn

    Case 7  ' OBä«óù
        strAppl = SQL_GET_PROFILE_STRING(gDbConnectionString, SECTION_BUTTON, "070")

        ' AccessLog -----------
        AF_InsUserAccessLog FUNC_000407, True, cnn

    Case 8  ' CTI
        strAppl = SQL_GET_PROFILE_STRING(gDbConnectionString, SECTION_BUTTON, "080")

        ' AccessLog -----------
        AF_InsUserAccessLog FUNC_000408, True, cnn

    Case 9  ' êÍópã∆ñ±
        strAppl = SQL_GET_PROFILE_STRING(gDbConnectionString, SECTION_BUTTON, "090")

        ' AccessLog -----------
        AF_InsUserAccessLog FUNC_000409, True, cnn

    Case 10  ' ÉÜÅ[ÉU
        strAppl = SQL_GET_PROFILE_STRING(gDbConnectionString, SECTION_BUTTON, "100")

        ' AccessLog -----------
        AF_InsUserAccessLog FUNC_000410, True, cnn

    Case 11    ' É}ÉXÉ^
        strAppl = SQL_GET_PROFILE_STRING(gDbConnectionString, SECTION_BUTTON, "110")

        ' AccessLog -----------
        AF_InsUserAccessLog FUNC_000411, True, cnn

    Case 12    ' ÉVÉXÉeÉÄ
        strAppl = SQL_GET_PROFILE_STRING(gDbConnectionString, SECTION_BUTTON, "120")

        ' AccessLog -----------
        AF_InsUserAccessLog FUNC_000412, True, cnn

    End Select

    cnn.Close

    If strAppl <> "" Then
        TraceLog LOG_INF, "ãNìÆÉAÉvÉä: " & strAppl
        Rq = Shell(App.Path & "\" & strAppl & " " & gUser.UserID, vbNormalFocus)
    End If

Exit_btnMenu_Click:
    Exit Sub

Err_btnMenu_Click:
    ErrorBreak "btnMenu_Click"
    Resume Exit_btnMenu_Click

End Sub

'---------------------------------------------------------------------
' ñ⁄ìIê‡ñæ  -- ÉfÅ[É^éÛêM
' à¯êî      --
' ñﬂÇËíl    -- Ç»Çµ
'---------------------------------------------------------------------
Private Sub afValue_OnData(strData As String)

    TraceLog LOG_DBG, Me.Name & ".OnData=" & strData

    Select Case strData
        '----------------------------------
    Case "LOCK"         'ÉçÉbÉNíÜ(çÏã∆,ó£ê»,ãxåe,å§èC)
        '----------------------------------
    Case "UNLOCK"       'ÉçÉbÉNâèú
        '----------------------------------
    Case "ENDLOCK"      'ÉçÉbÉNîFèÿÇπÇ∏Ç…èIóπ(ãNìÆíÜÇÃÉAÉvÉäÇèIóπÇ≥ÇπÇÈ)
        'èIóπå„èàóùèàóù
        ExitProcedure
        End
        '----------------------------------
    Case "ENDPHONE"     'èIóπÇ≥ÇπÇÈ
        'èIóπå„èàóùèàóù
        ExitProcedure
        End

        '----------------------------------
    Case "ENDSYSTEM"    'Ç∑Ç◊ÇƒèIóπÇ≥ÇπÇÈ
        Unload Me
        Exit Sub

        '----------------------------------
    Case "CHANGEGROUP"  'ã∆ñ±êÿë÷

        'ÉçÉOÉIÉìèÓïÒÇì«çûÇ›
        LoadLogonData
        'çƒãNìÆ
        Form_Load

    End Select

End Sub

'---------------------------------------------------------------------
' ñ⁄ìIê‡ñæ  -- ïœêîïœçX
' à¯êî      --
' ñﬂÇËíl    -- Ç»Çµ
'---------------------------------------------------------------------
Private Sub afValue_OnValue(strName As String, strData As String)

    Select Case strName

    Case "ReadMessage"  'ê\ëóéñçÄ
        If strData = "1" Then
            btnMenu(3).BackColor = cRED3    'ñ¢ì«Ç†ÇË
        Else
            btnMenu(3).BackColor = cGRAY
        End If

    Case "ReadRequest"  'àÀóäèë
        If strData = "1" Then
            btnMenu(2).BackColor = cRED3    'ñ¢ì«Ç†ÇË
        Else
            btnMenu(2).BackColor = cGRAY
        End If

    End Select

End Sub

Private Sub GetUserFunctionPower()

    On Error GoTo Err_GetUserFunctionPower

    Dim FuncIDList As uUserFuncitonPower

    Dim UserFunctionID As String
    Dim FuncCategories As String

    Dim cnn As New ADODB.Connection
    Dim rs As New ADODB.Recordset
    Dim SQL As String

    cnn.Open gDbConnectionString

    SQL = "select FunctionID from TB_USERFUNCTIONPOWER where UserID = '" & gValue.UserID & "'"
    rs.Open SQL, cnn

    Do Until rs.EOF

        UserFunctionID = rs!FunctionID
        FuncCategories = Left(UserFunctionID, 2)

        Select Case FuncCategories
        Case "00"
            FuncIDList.A00 = FuncIDList.A00 & "," & UserFunctionID
        Case "01"
            FuncIDList.A01 = FuncIDList.A01 & "," & UserFunctionID
        Case "02"
            FuncIDList.A02 = FuncIDList.A02 & "," & UserFunctionID
        Case "03"
            FuncIDList.A03 = FuncIDList.A03 & "," & UserFunctionID
        Case "04"
            FuncIDList.A04 = FuncIDList.A04 & "," & UserFunctionID
        Case "05"
            FuncIDList.A05 = FuncIDList.A05 & "," & UserFunctionID
        Case "06"
            FuncIDList.A06 = FuncIDList.A06 & "," & UserFunctionID
        Case "07"
            FuncIDList.A07 = FuncIDList.A07 & "," & UserFunctionID
        Case "08"
            FuncIDList.A08 = FuncIDList.A08 & "," & UserFunctionID
        Case "09"
            FuncIDList.A09 = FuncIDList.A09 & "," & UserFunctionID
        Case "10"
            FuncIDList.A10 = FuncIDList.A10 & "," & UserFunctionID
        Case "11"
            FuncIDList.A11 = FuncIDList.A11 & "," & UserFunctionID
        Case "12"
            FuncIDList.A12 = FuncIDList.A12 & "," & UserFunctionID
        Case "13"
            FuncIDList.A13 = FuncIDList.A13 & "," & UserFunctionID
        End Select

        rs.MoveNext

    Loop

    rs.Close
    cnn.Close

    afValue.v("A00") = Mid(FuncIDList.A00, 2)
    afValue.v("A01") = Mid(FuncIDList.A01, 2)
    afValue.v("A02") = Mid(FuncIDList.A02, 2)
    afValue.v("A03") = Mid(FuncIDList.A03, 2)
    afValue.v("A04") = Mid(FuncIDList.A04, 2)
    afValue.v("A05") = Mid(FuncIDList.A05, 2)
    afValue.v("A06") = Mid(FuncIDList.A06, 2)
    afValue.v("A07") = Mid(FuncIDList.A07, 2)
    afValue.v("A08") = Mid(FuncIDList.A08, 2)
    afValue.v("A09") = Mid(FuncIDList.A09, 2)
    afValue.v("A10") = Mid(FuncIDList.A10, 2)
    afValue.v("A11") = Mid(FuncIDList.A11, 2)
    afValue.v("A12") = Mid(FuncIDList.A12, 2)
    afValue.v("A13") = Mid(FuncIDList.A13, 2)

Exit_GetUserFunctionPower:
    Exit Sub

Err_GetUserFunctionPower:
    MsgBox Err.Description
    Resume Exit_GetUserFunctionPower

End Sub

'---------------------------------------------------------------------
' ñ⁄ìIê‡ñæ  -- ÅufrmMainÅvÉtÉHÅ[ÉÄÉçÅ[Éh
' à¯êî      --
' ñﬂÇËíl    -- Ç»Çµ
'---------------------------------------------------------------------
Private Sub Form_Load()

    On Error GoTo Err_Form_Load

    Dim Rq As Long
    Dim strCom As String
    Dim strAppl As String

    Me.Move 17650, 0

    'ìdòbAPIê⁄ë±
    ucPhoneApi1.OpenTel "False"

    'ÉÜÅ[ÉUÅ[ÉOÉçÅ[ÉoÉãèÓïÒÉZÉbÉg (ã∆ñ±äJénéûÇ…ç\ë¢ëÃÇÃílÇAFÉOÉçÅ[ÉoÉãïœêîÇ…ë„ì¸ÇµÇ‹Ç∑ÅB)
    gValue.LogonMode = gLogonMode

    'AFÉOÉçÅ[ÉoÉãïœêîÇ…ë„ì¸
    afValue.v("UserID") = gValue.UserID
    afValue.v("OpeName") = gValue.UserName
    afValue.v("PCName") = gValue.PCName
    afValue.v("Extension") = gValue.Extension
    afValue.v("LogonMode") = gValue.LogonMode
    afValue.v("ClientCode") = gValue.ClientCode
    afValue.v("ClientName") = gValue.ClientName
    afValue.v("GroupCode") = gValue.GroupCode
    afValue.v("JobCode") = gValue.JobCode
    afValue.v("ListCode") = gValue.ListCode
    'START 20210525 êVÉäÉXÉgÉRÅ[Éã
    afValue.v("LogonSubMode") = gValue.LogonSubMode
    afValue.v("MainInOut") = gValue.MainInOut
    'END 20210525 êVÉäÉXÉgÉRÅ[Éã

    TraceLog LOG_DBG, "UserID[" & gValue.UserID & "] UerName[" & gValue.UserName & "] PC[" & gValue.PCName & "] Ext[" & gValue.Extension & "] Logon[" & gValue.LogonMode & "] ClientCode[" & gValue.ClientCode & "] ClientName[" & gValue.ClientName & "] Group[" & gValue.GroupCode & "] Job[" & gValue.JobCode & "] Lsit[" & gValue.ListCode & "]"

    ' ã@î\å†å¿ÇAF∏ﬁ€∞ ﬁŸïœêîÇ…ë„ì¸
    GetUserFunctionPower

    'ÉçÉOÉåÉxÉã(0=Ç»Çµ, 1=ERR, 2=ERR+WRN, 3=ERR+WRN+INF, 4=ERR+WRN+INF+SQL, 5à»è„=ALL)
    afValue.v("LogLevel") = SQL_GET_PROFILE_STRING(gDbConnectionString, SECTION_APPL, "LogLevel")
    If afValue.v("LogLevel") = "" Then
        afValue.v("LogLevel") = "9"
    End If
    gValue.LogLevel = CInt(afValue.v("LogLevel"))


    'SVìdòbã@ÇãNìÆÇ∑ÇÈ (UserID,çÏã∆èÛë‘éwíË,ìdòbã∆ñ±éÌï )
    '   çÏã∆èÛë‘éwíË (0=ÉçÉOÉIÉt(çÏã∆íÜ),1=ñ≥çÏã∆,2=ë“ã@(íÖêMë“Çø),3=çÏã∆)
    '   ìdòbã∆ñ±éÌï  (0=ñ¢ÉçÉOÉCÉì,1=PD,2=AC,3=PC,4=DPC,5=PV,6=DPV,7:=DC,8=DDC,9=IB)

    strAppl = SQL_GET_PROFILE_STRING(gDbConnectionString, SECTION_BUTTON, "200")
    If strAppl = "" Then strAppl = "AF_SVPHONE.exe"
    If strAppl = "AF_PHONECTL_NON.exe" Then strAppl = "AF_SVPHONE.exe"  '2009/5/27ïœçXÇµÇΩÇÃÇ≈ëOílÇ∆å›ä∑à€éùìÆçÏ
    strCom = gUser.UserID & "," & gWorkStatus & "," & gLogonMode
    Rq = Shell(App.Path & "\" & strAppl & " " & strCom, vbNormalFocus)

    ' Œﬁ¿›êßå‰
    mBtnControl

    'ÉÅÉjÉÖÅ[ï\é¶
    Me.Show
    DoEvents

    'ÉAÉEÉgÉoÉEÉìÉhÇÃÇ∆Ç´ÇÕÅuÉÅÉCÉìÅvÇãNìÆÇ∑ÇÈ
    ' (0=ñ¢ÉçÉOÉCÉì,1=PD,2=AC,3=PC,4=DPC,5=PV,6=DPV,7:=DC,8=DDC,9=IB,10=TEL)
    'ìdòbã@íPëÃà»äOÇ≈ÇÕÅuÉÅÉCÉìÅvÇãNìÆÇ∑ÇÈ
    If gValue.LogonMode <> 10 Then
        'ï°êîÉÅÉCÉìëŒâû (0=ÇPÇ¬ÇÃÇ›ÅA1=ï°êîâ¬î\) - ìdòbã@ÇÃãNìÆÇ™ä‘Ç…çáÇÌÇ∏ílÇ™ê≥ÇµÇ≠ì¸ÇÁÇ»Ç¢ÇÃÇ≈Ç±Ç±Ç≈éÊìæ
        ucPhoneApi1.MultiMain = SQL_GET_PROFILE_STRING(gDbConnectionString, SECTION_APPL, "MultiMain")
        'ÅuÉÅÉCÉìÅvÉ{É^Éìâüâ∫
        Call btnMenu_Click(0)
    Else
        'ìdòbã@íPëÃãNìÆ
        strAppl = SQL_GET_PROFILE_STRING(gDbConnectionString, SECTION_BUTTON, "270")
        If strAppl = "" Then strAppl = "AF_PHONE.exe"
        Rq = Shell(App.Path & "\" & strAppl & " " & gUser.UserID, vbNormalFocus)
    End If


Exit_Form_Load:
    Exit Sub

Err_Form_Load:
    ErrorBreak "Load"
    Resume Exit_Form_Load

End Sub

'---------------------------------------------------------------------
' ñ⁄ìIê‡ñæ  -- ÅufrmMainÅvÉtÉHÅ[ÉÄÉAÉìÉçÅ[Éh
' à¯êî      --
' ñﬂÇËíl    -- Ç»Çµ
'---------------------------------------------------------------------
Private Sub Form_Unload(Cancel As Integer)

    On Error GoTo Err_Form_Unload

    'ìdòbAPIêÿíf
    ucPhoneApi1.CloseTel

    'èIóπå„èàóùèàóù
    ExitProcedure

    End

Exit_Form_Unload:
    Exit Sub

Err_Form_Unload:
    ErrorBreak "Unload"
    Resume Exit_Form_Unload

End Sub

'---------------------------------------------------------------------
' ñ⁄ìIê‡ñæ  -- ìdòbïœêîïœçX
' à¯êî      --
' ñﬂÇËíl    -- Ç»Çµ
'---------------------------------------------------------------------
Private Sub ucPhoneApi1_OnValue(strName As String, strData As String)

    Select Case strName

    Case "MainIndex"                'ìdòbã@Ç∆ÅuÉÅÉCÉìÅvÇÃåãÇ—ïtÇØïœçX
        'ÅuÉÅÉCÉìÅvÇÕíPì∆égópÉÇÅ[ÉhÅH
        If ucPhoneApi1.MultiMain = 0 Or gLogonMode <> 9 Then
            If ucPhoneApi1.MainIndex = "" Or ucPhoneApi1.MainIndex = "0" Then
                btnMenu(0).Enabled = True       'ñ¢â“ì≠Ç≈Ç†ÇÍÇŒãNìÆâ¬î\
                TraceLog LOG_DBG, "ÅuÉÅÉCÉìÅvÉ{É^ÉìóLå¯"
            Else
                btnMenu(0).Enabled = False      'ìdòbã@Ç∆åãÇ—Ç¬Ç´Ç™Ç†ÇÍÇŒãNìÆïsâ¬
                TraceLog LOG_DBG, "ÅuÉÅÉCÉìÅvÉ{É^Éìñ≥å¯"
            End If
        End If

    End Select

End Sub



'---------------------------------------------------------------------
' ñ⁄ìIê‡ñæ  -- ÉçÉOÉCÉìÇ…ïKóvÇ»ÉfÅ[É^ÇAFValueÇ©ÇÁì«çûÇﬁ
' à¯êî      --
' ñﬂÇËíl    -- Ç»Çµ
'---------------------------------------------------------------------
Private Sub LoadLogonData()

'AFÉOÉçÅ[ÉoÉãïœêîÇ…ë„ì¸
    gValue.UserID = afValue.v("UserID")
    gValue.UserName = afValue.v("OpeName")
    gValue.PCName = afValue.v("PCName")
    gValue.Extension = afValue.v("Extension")

    gLogonMode = afValue.v("LogonMode")  'ÉçÉOÉIÉìÉÇÅ[ÉhÇÕÉOÉçÅ[ÉoÉãÇ÷
    'START 20210525 êVÉäÉXÉgÉRÅ[Éã
    gValue.LogonSubMode = afValue.v("LogonSubMode")
    gValue.MainInOut = afValue.v("MainInOut")
    'END 20210525 êVÉäÉXÉgÉRÅ[Éã

    gValue.ClientCode = afValue.v("ClientCode")
    gValue.ClientName = afValue.v("ClientName")
    gValue.GroupCode = afValue.v("GroupCode")
    gValue.JobCode = afValue.v("JobCode")
    gValue.ListCode = afValue.v("ListCode")


    TraceLog LOG_DBG, "UserID[" & gValue.UserID & "] UerName[" & gValue.UserName & "] PC[" & gValue.PCName & "] Ext[" & gValue.Extension & "] Logon[" & gLogonMode & "] ClientCode[" & gValue.ClientCode & "] ClientName[" & gValue.ClientName & "] Group[" & gValue.GroupCode & "] Job[" & gValue.JobCode & "] Lsit[" & gValue.ListCode & "]"

End Sub
